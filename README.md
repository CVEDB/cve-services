# CVE-API

[![Gitter](https://badges.gitter.im/cve-awg/community.svg)](https://gitter.im/cve-awg/community?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge)

## Table of contents

* [Technologies](#technologies)
* [Style Guidelines](#style-guidelines)
* [Directory Layout](#directory-layout)
* [Setup](#setup)
* [API Documentation](#api-documentation)
* [Unit Testing](#unit-testing)

## Technologies

This project uses or depends on software from

- NodeJS https://nodejs.org/
- Express https://github.com/expressjs
- MongoDB
- PM2 http://pm2.keymetrics.io/
- Mongoose.js https://mongoosejs.com

## Style Guidelines

This project uses the following Style Guidelines

- https://github.com/standard/standard

## Directory layout

### Top Level Directory

    .
    ├── src                     # Source files (This is where the API resides)
    ├── test                    # Automated tests (This is where the API tests reside)
    ├── LICENSE
    └── README.md               

### Src Directory

    .
    ├── ...
    ├── src                     # Source files (This is where the API resides)
    │   ├── config/             # Contains config file for MySQL DB and PM2 configuration
    │   ├── controller/         # All API logic resides here.
    │   ├── model/              # All Mongoose Schemas, models, and database logic.
    │   ├── middleware/         # Authentication middleware resides inside this folder. 
    │   ├── routes.js           # This is where routes get created and get tied back to their specific controller. 
    │   └── index.js            # Where everything begins.
    └── ...

## Setup

### Step 1. Install required node modules

```sh
    cd cve-services
    npm install
```

### Step 2. Setup and start MongoDB locally

    Install MongoDB locally
- https://docs.mongodb.com/manual/administration/install-community/

    Download MongoDB Compass (MongoDB GUI)
- https://www.mongodb.com/download-center/compass

### Step 3. Edit the src/config/config.json file to suite your requirements

    This config file is used to config variables for MongoDB

### Step 4. Create a .env file in the root folder

    This env file contains important variables needed.
    See .env-example for an example

### Step 5. Start the node application

In order to start a dev enviorment:

```sh
    npm run start:dev
```

In order to start a test enviorment with unit testing:

```sh
    npm run start:test
```

## Api Documentation

ApiDoc: http://apidocjs.com/

In order to create API docs run:

```sh
    npm run docs
```

This creates an html file that can be found under apidocs/

## Unit Testing

This project uses the following for unit testing

- https://mochajs.org/
- https://www.chaijs.com/

In order to run unit tests, use the following command:

```sh
    npm run start:test
```

## In order to view server logs and to stop server

To view logs:

```sh
    pm2 logs
```

To stop the server

```sh
    pm2 stop all
```
